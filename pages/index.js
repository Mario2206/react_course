import Head from 'next/head'
import Image from 'next/image'
import styles from '../styles/Home.module.css'
import { useState } from "react"

export default function Home() {

  const [ todoList, setTodoList ] = useState(["value"])
  const [currentTodoValue, setCurrentTodoValue] = useState("")
  const [currentTodoIndex, setCurrentTodoIndex] = useState(null)
  

  function onChangeTodoInput(e) {
    setCurrentTodoValue(e.target.value)
  }

  function addTodo() {
    setTodoList(prev => [...prev, currentTodoValue])
    setCurrentTodoValue("")
  }

  function editTodo(e) {
    setTodoList(prevTodoList => {
      prevTodoList[currentTodoIndex] = e.target.value ;
      return [...prevTodoList];
    })
  }

  return (
    <div className={styles.container}>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main className={styles.main}>
        <h1>Hello !</h1>
        <input value={currentTodoValue} onChange={onChangeTodoInput} />
        <button onClick={addTodo}>Add todo</button>
        {
          todoList.length > 0 && (
            todoList.map((todo, index) => (
              <div key={index} style={{display: "flex"}}>
                <input 
                value={todo} 
                disabled={currentTodoIndex !== index} 
                onChange={editTodo}
                />
                <button 
                onClick={() => setTodoList(prev => prev.filter((_, i) => i !== index))}
                >Delete</button>
                <button  
                onClick={()=>setCurrentTodoIndex(index)}
                >Edit</button>
              </div>
            ))
          )
        }
      </main>
    </div>
  )
}
